<main class="pergunta-resposta container">

  <!-- Área principal do jogo -->
  <div class="jogo" [class.jogo-iniciado]="!mostrarResultados">

    <!-- Pergunta atual -->
    <div *ngIf="!mostrarResultados" class="pergunta">
      <h2 class="texto-pergunta">{{ perguntas[indiceAtual].texto }}</h2>

      <ul class="respostas-pergunta">
        <li
          *ngFor="let resposta of perguntas[indiceAtual].respostas; let i = index"
          [attr.data-selecionada]="perguntas[indiceAtual].selecao === i ? true : null"
        >
          <div class="resposta-wrapper">
            <div
              class="resposta-label"
              (click)="selecionarResposta(i)"
              [class.selecionada]="perguntas[indiceAtual].selecao === i"
            >
              <input
                class="resposta-input"
                type="radio"
                [name]="'p_' + perguntas[indiceAtual].id"
                [value]="i"
                [checked]="perguntas[indiceAtual].selecao === i"
                hidden
              />
              {{ resposta }}
            </div>
          </div>
        </li>
      </ul>

      <button
        class="botao-pergunta"
        (click)="proximaPergunta()"
        [disabled]="perguntas[indiceAtual].selecao === null"
      >
        {{ indiceAtual < perguntas.length - 1 ? 'Próxima' : 'Finalizar' }}
      </button>
    </div>

    <!-- Resultados finais -->
    <div *ngIf="mostrarResultados" class="resultado" data-jogo-finalizado>
      <div class="item-resultado correta">
        <span class="contagem-resultado">{{ quantidadeCorretas }}</span>
        <span class="texto-resultado">Corretas</span>
      </div>
      <div class="item-resultado errada">
        <span class="contagem-resultado">{{ quantidadeErradas }}</span>
        <span class="texto-resultado">Erradas</span>
      </div>
      <div class="item-resultado">
        <span class="contagem-resultado">{{ quantidadeNaoRespondidas }}</span>
        <span class="texto-resultado">Não Respondidas</span>
      </div>

      <button class="botao-reiniciar" (click)="reiniciarQuiz()">Reiniciar Quiz</button>
    </div>

    <!-- Gabarito final: exibe apenas resposta correta e selecionada -->
    <div *ngIf="mostrarResultados" class="gabarito-final">
      <h3 class="titulo-gabarito">Respostas Corretas</h3>

      <div *ngFor="let pergunta of perguntas; let idx = index" class="bloco-gabarito">
        <p class="enunciado-gabarito">
          {{ idx + 1 }}. {{ pergunta.texto }}
        </p>

        <ul class="lista-respostas">
          <ng-container *ngFor="let resposta of pergunta.respostas; let i = index">
            <li
              *ngIf="i === pergunta.correta || i === pergunta.selecao"
              [class.correta]="i === pergunta.correta"
              [class.errada]="pergunta.selecao === i && i !== pergunta.correta"
              [class.selecionada]="pergunta.selecao === i"
            >
              {{ resposta }}
            </li>
          </ng-container>
        </ul>
      </div>
    </div>

  </div>
</main>
